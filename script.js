const translations = {
  ar: {
    topbar_location: "جدة، المملكة العربية السعودية",
    brand_name: "الأسس الصلبة",
    nav_about: "عن الشركة",
    nav_services: "الخدمات",
    nav_projects: "المشاريع",
    nav_quality: "الجودة",
    nav_contact: "تواصل معنا",
    nav_cta: "اطلب استشارة",
    hero_eyebrow: "نثبت الأسس، نبني المستقبل",
    hero_title: "حلول مقاولات متكاملة بهوية عصرية وجودة لا تقبل التنازل",
    hero_subtitle:
      "فريق هندسي بخبرة ميدانية واسعة، ننفذ المشاريع التجارية والسكنية والبنية التحتية وفق أعلى المعايير.",
    hero_cta_primary: "استعرض أعمالنا",
    hero_cta_secondary: "خدماتنا",
    metric_years: "سنة خبرة",
    metric_projects: "مشروع مكتمل",
    metric_partners: "شريك استراتيجي",
    hero_badge: "فريق مشاريع ميداني",
    hero_panel_title: "إدارة دقيقة للمخاطر",
    hero_panel_text: "منهجية تخطيط وتحكم تقلل التكاليف وتحافظ على الجداول الزمنية.",
    hero_panel_title_alt: "مواقع تعمل بسلامة كاملة",
    hero_panel_text_alt: "تطبيق صارم لمعايير الصحة والسلامة المهنية في كل موقع.",
    hero_panel_title_accent: "تقارير لحظية",
    hero_panel_text_accent: "لوحات متابعة متاحة للعميل مع مؤشرات الإنجاز.",
    home_overview_label: "نظرة سريعة",
    home_overview_title: "كل تبويبة في صفحة مستقلة",
    home_overview_text:
      "اكتشف خدماتنا ومشاريعنا ومعايير الجودة عبر صفحات مصممة بوضوح وتفاصيل مركزة.",
    home_card_about: "تعرف على قصتنا ورسالتنا في المقاولات.",
    home_card_services: "خدمات تنفيذ وتشغيل تغطي كل مراحل المشروع.",
    home_card_projects: "نماذج حقيقية لمشاريع أنجزناها بكفاءة.",
    home_card_quality: "حوكمة سلامة وجودة لضمان نتائج مضمونة.",
    home_card_contact: "تواصل مباشر لفهم احتياجات مشروعك القادم.",
    home_card_cta: "اذهب للصفحة",
    about_label: "عن الشركة",
    about_title: "الأسس الصلبة للمقاولات: من الفكرة حتى التسليم",
    about_text:
      "نعمل كشريك موثوق لعملائنا في جميع مراحل المشروع، من دراسة الجدوى والتصميم إلى التنفيذ والتسليم النهائي. نلتزم بجودة المواد، دقة التنفيذ، والشفافية الكاملة في التقارير.",
    about_chip_1: "إدارة مشاريع احترافية",
    about_chip_2: "شبكة موردين قوية",
    about_chip_3: "حلول هندسية متكاملة",
    about_image_title: "رؤية 360° للموقع",
    about_image_text: "مراقبة يومية، تقارير أسبوعية، وشفافية في كل مرحلة.",
    services_label: "خدماتنا",
    services_title: "مجموعة خدمات تغطي كل احتياج إنشائي",
    services_text: "ننفذ المشاريع بأسلوب يركز على الكفاءة والابتكار، مع فريق متعدد التخصصات.",
    service_1_title: "المقاولات العامة",
    service_1_text: "إدارة وتنفيذ كاملة للمشاريع السكنية والتجارية والصناعية.",
    service_2_title: "أعمال البنية التحتية",
    service_2_text: "شبكات المياه والصرف والطرق والأعمال الترابية.",
    service_3_title: "التشطيبات المتقدمة",
    service_3_text: "حلول تشطيب راقية للمكاتب، الفنادق، والمجمعات السكنية.",
    service_4_title: "إدارة المشاريع",
    service_4_text: "حوكمة كاملة، متابعة ميزانيات، وإدارة مخاطر دقيقة.",
    service_5_title: "سلاسل التوريد",
    service_5_text: "اختيار أفضل الموردين لضمان الجودة والتسليم في الوقت.",
    service_6_title: "حلول مستدامة",
    service_6_text: "ممارسات بناء تقلل الهدر وتحسن كفاءة الطاقة.",
    projects_label: "المشاريع",
    projects_title: "نماذج من مشاريعنا الحديثة",
    projects_text: "نركز على الجودة والالتزام بالمواعيد، مع فرق مراقبة لضمان نتائج دقيقة.",
    project_1_title: "مركز أعمال تجاري",
    project_1_text: "إدارة وتنفيذ شامل مع أنظمة ميكانيكية وكهربائية متقدمة.",
    project_2_title: "مجمع سكني حديث",
    project_2_text: "تسليم على مراحل مع تشطيبات فندقية متميزة.",
    project_3_title: "مشروع بنية تحتية",
    project_3_text: "تنفيذ شبكات وخدمات متكاملة وفق معايير السلامة.",
    quality_label: "الجودة والسلامة",
    quality_title: "معايير صارمة تحكم كل موقع",
    quality_text:
      "نهجنا يعتمد على مؤشرات أداء، وإشراف يومي، وتقارير لحظية تضمن الالتزام التام بالسلامة والجودة.",
    quality_item_1: "خطط سلامة معتمدة ومراجعات أسبوعية.",
    quality_item_2: "اختبارات جودة للمواد قبل وبعد التنفيذ.",
    quality_item_3: "تتبع التكاليف مقابل الإنجاز في لوحة واحدة.",
    quality_card_title: "شهادات واعتمادات",
    quality_badge: "تصنيف مقاولات",
    quality_badge_alt: "كفاءة تشغيلية",
    quality_stat_1: "معدل التزام السلامة: 98%",
    quality_stat_2: "تحسن كفاءة التنفيذ: 22%",
    quality_stat_3: "تسليم ضمن الجدول: 95%",
    contact_label: "تواصل معنا",
    contact_title: "جاهزون لمناقشة مشروعك القادم",
    contact_text: "شاركنا تفاصيل مشروعك وسنعود إليك بخطة تنفيذ واضحة وعرض مناسب.",
    about_page_title: "عن الأسس الصلبة",
    about_page_text: "رؤية واضحة، فريق هندسي متخصص، وشراكة طويلة المدى مع عملائنا.",
    services_page_title: "خدماتنا",
    services_page_text: "حلول تنفيذ وتشغيل تتماشى مع أهداف الجودة والميزانية.",
    projects_page_title: "مشاريعنا",
    projects_page_text: "نماذج مختارة لأعمال تعكس دقتنا في التسليم.",
    quality_page_title: "الجودة والسلامة",
    quality_page_text: "نهج صارم يضمن الامتثال والسلامة في كل موقع.",
    contact_page_title: "تواصل معنا",
    contact_page_text: "نستقبل استفساراتك ونبني معك خطة تنفيذ واضحة.",
    contact_phone_label: "الهاتف",
    contact_email_label: "البريد",
    contact_address_label: "العنوان",
    contact_address: "حي الشاطئ، جدة",
    form_name: "الاسم الكامل",
    form_company: "الشركة",
    form_email: "البريد الإلكتروني",
    form_phone: "رقم التواصل",
    form_message: "تفاصيل المشروع",
    form_submit: "إرسال الطلب",
    form_name_placeholder: "محمد أحمد",
    form_company_placeholder: "اسم الشركة",
    form_email_placeholder: "name@example.com",
    form_phone_placeholder: "05xxxxxxxx",
    form_message_placeholder: "صف المشروع بإيجاز",
    footer_tagline: "نبني بثقة، وننفذ بتميز.",
    footer_text: "خبرة هندسية وميدانية ممتدة، نقدم حلول مقاولات متكاملة برؤية حديثة.",
    footer_links: "روابط",
    footer_resources: "موارد",
    footer_follow: "تابعنا",
    footer_rights: "جميع الحقوق محفوظة © الأسس الصلبة للمقاولات",
  },
  en: {
    topbar_location: "Jeddah, Saudi Arabia",
    brand_name: "Solid Foundations",
    nav_about: "About",
    nav_services: "Services",
    nav_projects: "Projects",
    nav_quality: "Quality",
    nav_contact: "Contact",
    nav_cta: "Request a consult",
    hero_eyebrow: "We secure the base, we build the future",
    hero_title: "Integrated contracting solutions with modern execution and uncompromising quality",
    hero_subtitle:
      "A field-proven engineering team delivering commercial, residential, and infrastructure projects to the highest standards.",
    hero_cta_primary: "View our work",
    hero_cta_secondary: "Our services",
    metric_years: "Years of experience",
    metric_projects: "Completed projects",
    metric_partners: "Strategic partners",
    hero_badge: "On-site delivery team",
    hero_panel_title: "Precise risk control",
    hero_panel_text: "Planning and control methodology that keeps budgets and timelines aligned.",
    hero_panel_title_alt: "Safety-first sites",
    hero_panel_text_alt: "Strict implementation of health and safety protocols in every location.",
    hero_panel_title_accent: "Live reporting",
    hero_panel_text_accent: "Client dashboards with progress indicators and milestones.",
    home_overview_label: "Quick overview",
    home_overview_title: "Each tab has its own page",
    home_overview_text: "Explore our services, projects, and quality standards in focused pages.",
    home_card_about: "Discover our story and contracting mission.",
    home_card_services: "Execution services that cover every project stage.",
    home_card_projects: "Real examples of work delivered with precision.",
    home_card_quality: "Safety and quality governance you can trust.",
    home_card_contact: "Direct contact to understand your next project.",
    home_card_cta: "Visit page",
    about_label: "About",
    about_title: "Solid Foundations Contracting: from concept to handover",
    about_text:
      "We partner with clients across all project phases, from feasibility and design to execution and final delivery. We commit to material quality, execution precision, and transparent reporting.",
    about_chip_1: "Professional project management",
    about_chip_2: "Reliable supplier network",
    about_chip_3: "End-to-end engineering solutions",
    about_image_title: "360° site visibility",
    about_image_text: "Daily monitoring, weekly reports, and transparent delivery in every phase.",
    services_label: "Services",
    services_title: "A service suite that covers every construction need",
    services_text: "We deliver with efficiency and innovation, supported by a multidisciplinary team.",
    service_1_title: "General contracting",
    service_1_text: "Full delivery for residential, commercial, and industrial builds.",
    service_2_title: "Infrastructure works",
    service_2_text: "Water, sewage, roads, and earthworks systems.",
    service_3_title: "Advanced finishing",
    service_3_text: "Premium finishing solutions for offices, hotels, and residences.",
    service_4_title: "Project management",
    service_4_text: "Governance, budget tracking, and precision risk management.",
    service_5_title: "Supply chain",
    service_5_text: "Selecting top suppliers to ensure quality and on-time delivery.",
    service_6_title: "Sustainable solutions",
    service_6_text: "Building practices that reduce waste and improve energy efficiency.",
    projects_label: "Projects",
    projects_title: "Recent project highlights",
    projects_text: "We focus on quality and on-time delivery, backed by monitoring teams.",
    project_1_title: "Commercial business center",
    project_1_text: "End-to-end execution with advanced MEP systems.",
    project_2_title: "Modern residential complex",
    project_2_text: "Phased delivery with premium hotel-grade finishing.",
    project_3_title: "Infrastructure program",
    project_3_text: "Integrated networks delivered to safety standards.",
    quality_label: "Quality & safety",
    quality_title: "Strict standards on every site",
    quality_text:
      "Our approach is built on KPIs, daily supervision, and live reports that ensure full compliance with safety and quality.",
    quality_item_1: "Approved safety plans with weekly audits.",
    quality_item_2: "Material quality tests before and after execution.",
    quality_item_3: "Cost-to-progress tracking in a single dashboard.",
    quality_card_title: "Certifications",
    quality_badge: "Contractor classification",
    quality_badge_alt: "Operational excellence",
    quality_stat_1: "Safety compliance rate: 98%",
    quality_stat_2: "Execution efficiency gain: 22%",
    quality_stat_3: "On-time delivery: 95%",
    contact_label: "Contact",
    contact_title: "Ready to discuss your next project",
    contact_text: "Share your project details and we will respond with a clear execution plan.",
    about_page_title: "About Solid Foundations",
    about_page_text: "A clear vision, specialized engineering team, and long-term client partnerships.",
    services_page_title: "Our Services",
    services_page_text: "Execution and operations solutions aligned with quality and budget goals.",
    projects_page_title: "Our Projects",
    projects_page_text: "A curated look at projects delivered with precision.",
    quality_page_title: "Quality & Safety",
    quality_page_text: "A strict approach that guarantees compliance and safety on every site.",
    contact_page_title: "Contact Us",
    contact_page_text: "We welcome your inquiry and build a clear delivery plan with you.",
    contact_phone_label: "Phone",
    contact_email_label: "Email",
    contact_address_label: "Address",
    contact_address: "Al Shati District, Jeddah",
    form_name: "Full name",
    form_company: "Company",
    form_email: "Email address",
    form_phone: "Contact number",
    form_message: "Project details",
    form_submit: "Send request",
    form_name_placeholder: "John Smith",
    form_company_placeholder: "Company name",
    form_email_placeholder: "name@example.com",
    form_phone_placeholder: "+966 5x xxx xxxx",
    form_message_placeholder: "Briefly describe the project",
    footer_tagline: "We build with confidence and deliver with excellence.",
    footer_text: "Field-proven engineering experience delivering modern, end-to-end contracting solutions.",
    footer_links: "Links",
    footer_resources: "Resources",
    footer_follow: "Follow",
    footer_rights: "All rights reserved © Solid Foundations Contracting",
  },
};

let revealObserver;
let counterObserver;

function handleScroll() {
  const nav = document.querySelector(".site-nav");
  const toTopButton = document.querySelector(".to-top");

  if (window.scrollY > 80) {
    if (nav) {
      nav.classList.add("is-scrolled");
    }
    if (toTopButton) {
      toTopButton.classList.add("is-visible");
    }
  } else {
    if (nav) {
      nav.classList.remove("is-scrolled");
    }
    if (toTopButton) {
      toTopButton.classList.remove("is-visible");
    }
  }
}

function initUI() {
  const elements = document.querySelectorAll("[data-i18n]");
  const placeholders = document.querySelectorAll("[data-i18n-placeholder]");
  const langToggle = document.querySelector("[data-lang-toggle]");
  const html = document.documentElement;
  const body = document.body;
  const ltrStylesheet = document.getElementById("bootstrap-ltr");
  const rtlStylesheet = document.getElementById("bootstrap-rtl");

  let currentLang = html.getAttribute("lang") === "en" ? "en" : "ar";

  function setLanguage(lang) {
    currentLang = lang;
    const dictionary = translations[lang];

    elements.forEach((element) => {
      const key = element.getAttribute("data-i18n");
      if (dictionary[key]) {
        element.textContent = dictionary[key];
      }
    });

    placeholders.forEach((element) => {
      const key = element.getAttribute("data-i18n-placeholder");
      if (dictionary[key]) {
        element.setAttribute("placeholder", dictionary[key]);
      }
    });

    if (lang === "en") {
      html.setAttribute("dir", "ltr");
      html.setAttribute("lang", "en");
      body.classList.add("is-ltr");
      ltrStylesheet.disabled = false;
      rtlStylesheet.disabled = true;
      if (langToggle) {
        langToggle.textContent = "AR";
      }
    } else {
      html.setAttribute("dir", "rtl");
      html.setAttribute("lang", "ar");
      body.classList.remove("is-ltr");
      ltrStylesheet.disabled = true;
      rtlStylesheet.disabled = false;
      if (langToggle) {
        langToggle.textContent = "EN";
      }
    }
  }

  if (langToggle && !langToggle.dataset.bound) {
    langToggle.addEventListener("click", () => {
      setLanguage(currentLang === "ar" ? "en" : "ar");
    });
    langToggle.dataset.bound = "true";
  }

  setLanguage(currentLang);

  if (!revealObserver) {
    revealObserver = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add("is-visible");
          }
        });
      },
      { threshold: 0.15 }
    );
  }

  document.querySelectorAll(".reveal").forEach((el) => {
    if (!el.dataset.revealObserved) {
      revealObserver.observe(el);
      el.dataset.revealObserved = "true";
    }
  });

  if (!counterObserver) {
    counterObserver = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            const target = entry.target;
            const endValue = Number(target.getAttribute("data-count"));
            const valueEl = target.querySelector(".metric-value");
            let start = 0;
            const step = Math.max(1, Math.floor(endValue / 40));
            const interval = setInterval(() => {
              start += step;
              if (start >= endValue) {
                start = endValue;
                clearInterval(interval);
              }
              valueEl.textContent = start;
            }, 35);
            counterObserver.unobserve(target);
          }
        });
      },
      { threshold: 0.4 }
    );
  }

  document.querySelectorAll("[data-count]").forEach((counter) => {
    if (!counter.dataset.countObserved) {
      counterObserver.observe(counter);
      counter.dataset.countObserved = "true";
    }
  });

  if (!body.dataset.scrollBound) {
    window.addEventListener("scroll", handleScroll);
    body.dataset.scrollBound = "true";
  }

  handleScroll();

  const toTopButton = document.querySelector(".to-top");
  if (toTopButton && !toTopButton.dataset.bound) {
    toTopButton.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
    });
    toTopButton.dataset.bound = "true";
  }
}

if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", initUI);
} else {
  initUI();
}

document.addEventListener("components:loaded", initUI);
